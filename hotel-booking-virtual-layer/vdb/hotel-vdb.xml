<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<vdb name="hotel" version="1">

  <description>Hotel VDB</description>
      <model name="Monolith" visible="false">
        <property name="importer.useFullSchemaName" value="false"/>
        <property name="importer.TableTypes" value="TABLE" />
        <property name="importer.importKeys" value="false"/>
        <property name="importer.schemapattern" value="public"/>
        <source name="monolithdb" translator-name="postgresql" connection-jndi-name="java:/monolithdb"/>
    </model>
    <model name="DataServiceLayer" type="VIRTUAL" visible="true">
        <metadata type="DDL"><![CDATA[

        CREATE VIEW hotel(
            id integer NOT NULL,
            name string(256) NOT NULL,
            stars decimal NOT NULL,
            email string(256) NOT NULL,
            url string(256) NOT NULL,
            address string(256) NOT NULL,
            city string(256) NOT NULL,
            postal_code string(256) NOT NULL,
            country string(256) NOT NULL,
            CONSTRAINT hotel_pk PRIMARY KEY(id)
        )
        AS
            SELECT
                h.id,
                h.name,
                h.stars,
                h.email,
                h.url,
                h.address_line_1,
                c.name,
                c.postal_code,
                y.name
            FROM
                Monolith.hotel as h inner join Monolith.city as c on (h.city_id = c.id)
                                    inner join Monolith.country as y on (c.country_id = y.id);

        CREATE VIEW user(
            id integer NOT NULL,
            email string(256) NOT NULL,
            password string(256) NOT NULL,
            CONSTRAINT user_pk PRIMARY KEY(id)
        )
        AS
            SELECT
                c.id,
                c.email,
                c.password
            FROM
                Monolith.customer c;

        CREATE VIEW reservation(
            id integer NOT NULL,
            checkin date NOT NULL,
            checkout date NOT NULL,
            daily_rate double NOT NULL,
            status string(256) NOT NULL,
            cust_name string(256) NOT NULL,
            cust_email string(256) NOT NULL,
            cust_member_since date NOT NULL,
            cust_rewards_id string(256) NOT NULL,
            cust_address string(256) NOT NULL,
            cust_city string(256) NOT NULL,
            cust_postal_code string(256) NOT NULL,
            cust_country string(256) NOT NULL,
            hotel_name string(256) NOT NULL,
            hotel_address string(256) NOT NULL,
            hotel_city string(256) NOT NULL,
            hotel_postal_code string(256) NOT NULL,
            hotel_country string(256) NOT NULL,
            room_number string(256) NOT NULL,
            room_floor integer NOT NULL,
            living_area boolean NOT NULL,
            microwave boolean NOT NULL,
            num_adjoining_rooms integer NOT NULL,
            num_double_beds integer NOT NULL,
            num_king_beds integer NOT NULL,
            num_pets integer NOT NULL,
            num_pullouts integer NOT NULL,
            num_queen_beds integer NOT NULL,
            refrigerator boolean NOT NULL,
            smoking boolean NOT NULL,
            CONSTRAINT reservation_pk PRIMARY KEY(id)
        )
        AS
            SELECT
                r.id,
                r.checkin,
                r.checkout,
                r.daily_rate,
                r.status,
                c.name,
                c.email,
                c.member_since,
                c.rewards_id,
                c.address_line_1,
                cc.name,
                cc.postal_code,
                cy.name,
                h.name,
                h.address_line_1,
                hc.name,
                hc.postal_code,
                hy.name,
                r.room_number,
                r.floor,
                rc.living_area,
                rc.microwave,
                rc.num_adjoining_rooms,
                rc.num_double_beds,
                rc.num_king_beds,
                rc.num_pets,
                rc.num_pullouts,
                rc.num_queen_beds,
                rc.refrigerator,
                rc.smoking
            FROM
                Monolith.reservation as r inner join Monolith.customer as c on (r.customer_id = c.id)
                                          inner join Monolith.city as cc on (c.city_id = cc.id)
                                          inner join Monolity.country as cy on (cc.country_id = cy.id)
                                          inner join Monolith.room rm on (r.room_id = rm.id)
                                          inner join Monolith.room_config as rc on (r.room_config_id = rc.id)
                                          inner join Monolith.hotel as h on (r.hotel_id = h.id)
                                          inner join Monolith.city as hc on (h.city_id = hc.id)
                                          inner join Monolity.country as hy on (hc.country_id = hy.id);
        ]]></metadata>
    </model>
</vdb>
