<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<vdb name="inventory" version="1">

  <description>Inventory VDB</description>
      <model name="Monolith" visible="false">
        <property name="importer.useFullSchemaName" value="false"/>
        <property name="importer.TableTypes" value="TABLE" />
        <property name="importer.importKeys" value="false"/>
        <property name="importer.schemapattern" value="public"/>
        <source name="monolithdb" translator-name="postgresql" connection-jndi-name="java:/monolithdb"/>
    </model>
    <model name="DataServiceLayer" type="VIRTUAL" visible="true">
        <metadata type="DDL"><![CDATA[

        CREATE VIEW hotel_inventory(
            hotel_id integer NOT NULL,
            room_total_number integer NOT NULL,
            room_available_number integer NOT NULL,
            CONSTRAINT hotel_inventory_pk PRIMARY KEY(hotel_id)
        )
        AS
            SELECT
                h.id as hotel_id,
                count(rm.id) as room_total_number,
                0 as room_available_number
            FROM
                Monolith.hotel as h left join room rm on (h.id = rm.hotel_id) group by h.id;
        ]]></metadata>
    </model>
</vdb>
